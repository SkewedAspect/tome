//----------------------------------------------------------------------------------------------------------------------
// Handles user serialization/deserialization
//
// @module serialization.js
//----------------------------------------------------------------------------------------------------------------------

const passport = require('passport');
const dbMan = require('../database');

//----------------------------------------------------------------------------------------------------------------------

const db = dbMan.getDB();

//----------------------------------------------------------------------------------------------------------------------

passport.serializeUser((account, done) =>
{
    done(null, account.account_id);
});

passport.deserializeUser((account_id, done) =>
{
    db('account')
        .select()
        .where({ account_id })
        .then(([ account ]) =>
        {
            done(null, account);
        })
        .catch((error) =>
        {
            done(error);
        });
});

//----------------------------------------------------------------------------------------------------------------------
